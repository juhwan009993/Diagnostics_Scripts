# W-78: 보안 채널 데이터 디지털 암호화/서명 점검

## 1. 개요

이 디렉터리는 KISA의 주요정보통신기반시설 기술적 취약점 가이드라인의 `W-78: 보안 채널 데이터 디지털 암호화 또는 서명` 항목에 대한 자동화 스크립트와 관련 문서를 포함합니다.

도메인 멤버와 도메인 컨트롤러 간의 NetLogon 보안 채널을 통해 전송되는 데이터가 암호화되거나 서명되지 않으면, 중간자 공격(MitM)을 통해 인증 정보가 탈취되거나 데이터가 변조될 수 있습니다. 이는 제로로그온(Zerologon)과 같은 치명적인 공격으로 이어질 수 있습니다.

## 2. 파일 설명

- `W-78.ps1`
  - **설명**: 메인 점검 및 조치 스크립트입니다. NetLogon 보안 채널의 암호화 및 서명을 강제하는 레지스트리 값들을 확인하고, 취약점 발견 시 자동으로 조치합니다.
  - **실행 전제 조건**: Active Directory 도메인에 가입된 Windows Server, 관리자 권한

- `set_vulnerability_W-78.md`
  - **설명**: 테스트 목적으로 시스템을 의도적으로 취약한 상태로 만드는 수동 절차를 안내합니다.

## 3. 사용법

### 3.1. 취약점 점검 및 자동 조치

`W-78.ps1` 스크립트는 `-a` 매개변수를 통해 세 가지 모드로 실행될 수 있습니다: `Detect`, `Remediate`, `Restore`. 기본값은 `Detect`입니다.

1.  PowerShell을 **관리자 권한**으로 실행합니다.
2.  스크립트가 있는 디렉터리로 이동합니다.
    ```powershell
    cd W-78
    ```

3.  **점검 모드 (Detect - 기본값)**
    *   시스템의 보안 채널 정책 설정 취약점만을 점검합니다.
    *   실행 명령:
        ```powershell
        .\W-78.ps1
        ```

4.  **조치 모드 (Remediate)**
    *   취약점을 점검하고, 발견된 관련 정책을 '사용(1)'으로 설정합니다.
    *   실행 명령:
        ```powershell
        .\W-78.ps1 -a Remediate
        ```

5.  **복원 모드 (Restore)**
    *   이전에 `Remediate` 모드에서 백업된 설정을 사용하여 원래 상태로 복원합니다.
    *   실행 명령:
        ```powershell
        .\W-78.ps1 -a Restore
        ```

6.  모든 실행 결과는 `KISA_RESULT/` 디렉터리에 로그 및 JSON 파일로 저장됩니다.

### 3.2. 취약점 상태 재현 (테스트용)

테스트를 위해 시스템을 의도적으로 취약한 상태로 만들려면 `set_vulnerability_W-78.md` 를 읽고 진행하세요.

