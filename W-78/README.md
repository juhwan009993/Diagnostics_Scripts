# W-78: 보안 채널 데이터 디지털 암호화/서명 점검

## 1. 개요

이 디렉터리는 KISA의 주요정보통신기반시설 기술적 취약점 가이드라인의 `W-78: 보안 채널 데이터 디지털 암호화 또는 서명` 항목에 대한 자동화 스크립트와 관련 문서를 포함합니다.

도메인 멤버와 도메인 컨트롤러 간의 NetLogon 보안 채널을 통해 전송되는 데이터가 암호화되거나 서명되지 않으면, 중간자 공격(MitM)을 통해 인증 정보가 탈취되거나 데이터가 변조될 수 있습니다. 이는 제로로그온(Zerologon)과 같은 치명적인 공격으로 이어질 수 있습니다.

## 2. 파일 설명

- `W-78.ps1`
  - **설명**: 메인 점검 및 조치 스크립트입니다. NetLogon 보안 채널의 암호화 및 서명을 강제하는 3가지 핵심 레지스트리 값(`RequireSignOrSeal`, `SealSecureChannel`, `SignSecureChannel`)을 확인합니다. 이 값들이 '사용(1)'으로 설정되어 있지 않으면 취약점으로 진단하고, 사용자 동의 하에 자동으로 보안 설정을 강화합니다.
  - **실행 전제 조건**: Active Directory 도메인에 가입된 Windows Server, 관리자 권한

- `set_vulnerabilities.ps1`
  - **설명**: 테스트 목적으로 시스템을 의도적으로 취약하게 만드는 스크립트입니다. `RequireSignOrSeal` 레지스트리 값을 `0`(사용 안 함)으로 설정하여 보안 채널의 보호 수준을 낮춥니다.
  - **경고**: **테스트 및 시연 목적으로만 사용해야 합니다.** 운영 환경에서는 절대 사용하지 마십시오.

- `W-78.md`
  - **설명**: `W-78.ps1` 스크립트에 대한 상세 설명서입니다. 탐지 및 수정 원리, 시스템 전제조건, 관련 MITRE ATT&CK 기술 매핑 등의 내용을 포함합니다.

- `W-78_Script_Analysis.md`
  - **설명**: 전문가를 위한 스크립트 심층 분석 문서입니다. 레지스트리 값의 의미와 관련 공격 벡터(예: 제로로그온), 그리고 보안 원리를 상세히 기술합니다.

## 3. 사용법

### 3.1. 취약점 점검 및 자동 조치

1.  PowerShell을 **관리자 권한**으로 실행합니다.
2.  스크립트가 있는 디렉터리로 이동합니다.
    ```powershell
    cd W-78
    ```
3.  메인 스크립트를 실행합니다.
    ```powershell
    .\W-78.ps1
    ```
4.  스크립트가 취약점을 발견하면 자동으로 조치할지 묻습니다. `y`를 입력하면 모든 관련 정책이 '사용(1)'으로 설정됩니다.
5.  모든 실행 과정은 `KISA_LOG/W-78.log`에 기록되며, 최종 결과는 `KISA_RESULT/W-78.json` 파일에 저장됩니다.

### 3.2. 취약점 상태 재현 (테스트용)

1.  PowerShell을 **관리자 권한**으로 실행합니다.
2.  스크립트가 있는 디렉터리로 이동합니다.
    ```powershell
    cd W-78
    ```
3.  취약점 재현 스크립트를 실행합니다.
    ```powershell
    .\set_vulnerabilities.ps1
    ```

---
*이 문서는 제공된 프로젝트 파일들을 기반으로 자동 생성되었습니다.*
