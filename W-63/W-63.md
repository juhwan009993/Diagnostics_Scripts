# W-63: DNS 서비스 동적 업데이트 설정 점검 스크립트 보고서 (상세)

## 스크립트 설명

### 시스템 전제조건
- 점검 대상 시스템은 Windows Server 운영체제이며, **DNS 서버 역할**이 설치 및 실행 중이어야 합니다.
- 이 스크립트는 DNS 서버로 동작하지 않는 일반 서버나 클라이언트에는 적용되지 않습니다.

### 탐지 설명
- **원리**: DNS 동적 업데이트는 DNS 클라이언트가 자신의 IP 주소 변경 등을 DNS 서버의 Zone 파일에 자동으로 등록 및 업데이트하는 기능입니다. 이 기능 중 '안전하지 않음(Nonsecure)' 설정은 인증 없이 모든 클라이언트의 업데이트 요청을 허용하므로, 공격자가 악의적인 DNS 레코드를 주입하여(DNS Zone Poisoning) 사용자를 피싱 사이트로 유도하거나 트래픽을 가로챌 수 있는 심각한 위협이 됩니다. '안전(Secure)' 설정은 Active Directory 인증을 사용하므로 더 안전하지만, 매우 엄격한 통제가 필요한 환경에서는 이마저도 비활성화하고 모든 레코드를 수동으로 관리하는 것을 권장합니다.
- **탐지 방식**: 스크립트는 `DnsServer` 파워셸 모듈의 `Get-DnsServerPrimaryZone` cmdlet을 사용하여 서버에 호스팅된 모든 주 DNS 영역(Primary Zone)을 열거합니다. 각 영역의 `DynamicUpdate` 속성을 확인하며, 이 속성 값이 `None`이 아닌 경우('Secure' 또는 'NonsecureAndSecure') 해당 영역을 '취약' 상태로 진단합니다.
- **점검 범위 및 예외 처리**: 이 스크립트는 `Get-DnsServerPrimaryZone`을 사용하므로 **주 DNS 영역(Primary Zone)만을 점검 대상**으로 한정합니다. 만약 서버에 주 DNS 영역이 없거나(예: 캐싱 전용 서버), DNS 서비스 자체가 없는 경우, 스크립트는 이를 취약점이 적용되지 않는 '양호' 상태로 판단하고 별도의 조치 없이 점검을 완료합니다. 이는 점검의 정확성을 높이고, 대상이 아닌 시스템에서 불필요한 경고가 발생하는 것을 방지합니다.

### 수정 설명
- **원리**: 스크립트는 DNS 영역의 데이터 무결성을 보장하기 위해, 클라이언트로부터의 자동 업데이트 요청을 모두 거부하도록 DNS 영역의 정책을 수정합니다. 이를 통해 관리자가 승인한 레코드만 DNS 서비스에 반영되도록 강제합니다.
- **수정 방식**: '취약'으로 진단된 각 DNS 영역에 대해, 스크립트는 `Set-DnsServerPrimaryZone` cmdlet을 실행합니다. 이때 `-DynamicUpdate None` 파라미터를 사용하여 해당 영역이 더 이상 동적 업데이트를 허용하지 않도록 설정을 변경합니다. 조치 후, 스크립트는 다시 `DynamicUpdate` 속성을 조회하여 실제 설정이 성공적으로 'None'으로 변경되었는지 검증하고 최종 조치 결과를 판단합니다.

## MITRE ATT&CK TTP Mapping

이 취약점은 공격자가 DNS 정보를 조작하여 중간자 공격(MitM)을 수행하는 기반을 마련해 주며, 다음 MITRE ATT&CK 기술과 관련됩니다.

- **T1565.002 (Transmitted Data Manipulation):** '안전하지 않은' 동적 업데이트를 허용하는 DNS 서버는 공격자의 데이터 조작 공격에 취약합니다. 공격자는 악의적으로 조작된 DNS 업데이트 패킷을 전송하여 정상적인 DNS 레코드를 변경하거나 새로운 레코드를 삽입할 수 있습니다. 이를 통해 특정 도메인의 트래픽을 공격자의 서버로 리디렉션하는 등의 공격이 가능해집니다.
