# W-24: NetBIOS 바인딩 서비스 구동 점검 스크립트 보고서 (상세)

## 스크립트 설명

### 시스템 전제조건
- 점검 대상 시스템은 Windows Server 운영체제여야 합니다.
- 하나 이상의 네트워크 어댑터에 TCP/IP 프로토콜이 활성화되어 있어야 점검이 가능합니다.

### 탐지 설명
- **원리**: NetBIOS over TCP/IP는 레거시 응용프로그램과의 호환성을 위해 파일/프린터 공유 및 이름 확인 기능을 제공하는 프로토콜입니다. 하지만 이 프로토콜은 인증 및 암호화가 취약하여 외부에 노출될 경우, 시스템 이름, 사용자 계정 등 내부 정보를 유출하거나 SMB 트래픽 탈취, 무차별 대입 공격의 경로로 악용될 수 있습니다. 따라서 인터넷에 직접 연결되거나 보안이 중요한 네트워크 환경에서는 NetBIOS를 비활성화하는 것이 필수적입니다.
- **탐지 방식**: 스크립트는 `Win32_NetworkAdapterConfiguration` WMI 클래스를 조회하여 IP가 활성화된 모든 네트워크 인터페이스의 정보를 가져옵니다. 각 인터페이스의 `TcpipNetbiosOptions` 속성 값을 확인하며, 이 값은 NetBIOS의 활성화 상태를 나타냅니다.
  - `0`: DHCP 서버 설정에 따름
  - `1`: 사용
  - `2`: 사용 안 함
- 스크립트는 이 값이 `2` (사용 안 함)가 아닌 모든 인터페이스를 '취약' 상태로 진단합니다. DHCP 서버가 NetBIOS를 활성화하도록 설정했을 수 있으므로, `0` 역시 잠재적 취약점으로 간주합니다.

### 수정 설명
- **원리**: 스크립트는 취약점으로 발견된 각 네트워크 인터페이스에 대해 NetBIOS over TCP/IP 기능을 프로그래밍 방식으로 비활성화하여 정보 유출 및 공격 위협을 제거합니다.
- **수정 방식**: '취약'으로 진단된 인터페이스에 대해, 스크립트는 해당 `Win32_NetworkAdapterConfiguration` WMI 객체의 `SetTcpipNetbios` 메서드를 호출합니다. 이때 인자값으로 `2`를 전달하여 NetBIOS 설정을 '사용 안 함'으로 명시적으로 변경합니다. 조치 명령 실행 후, 스크립트는 다시 `TcpipNetbiosOptions` 속성 값을 조회하여 실제 설정이 성공적으로 변경되었는지 검증하고 최종 조치 결과를 판단합니다.

## MITRE ATT&CK TTP Mapping

이 취약점은 공격자가 시스템을 정찰하고 원격으로 접근하는 데 악용될 수 있으며, 다음 MITRE ATT&CK 기술과 관련됩니다.

- **T1046 (Network Service Scanning):** 공격자는 활성화된 NetBIOS 서비스를 스캔하여 시스템 이름, 도메인 정보, 실행 중인 서비스 등을 파악하고 이를 기반으로 추가 공격을 계획할 수 있습니다.
- **T1021 (Remote Services):** NetBIOS와 연관된 SMB(Server Message Block) 서비스는 원격 접근을 위한 통로입니다. 만약 이 서비스에 취약점이 존재하거나 약한 암호가 설정되어 있을 경우, 공격자는 이를 통해 시스템에 침투하거나 악성코드를 실행할 수 있습니다.
