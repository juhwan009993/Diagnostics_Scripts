# W-24: NetBIOS 바인딩 서비스 구동 점검

## 1. 개요

이 디렉터리는 KISA의 주요정보통신기반시설 기술적 취약점 가이드라인의 `W-24: NetBIOS 바인딩 서비스 구동 점검` 항목에 대한 자동화 스크립트와 관련 문서를 포함합니다.

NetBIOS over TCP/IP는 레거시 응용프로그램과의 호환성을 위해 제공되지만, 인증 및 암호화가 취약하여 시스템 정보 유출, SMB 트래픽 탈취 등 다양한 공격에 악용될 수 있습니다. 따라서 보안이 중요한 네트워크 환경에서는 비활성화하는 것이 필수적입니다.

## 2. 파일 설명

- `W-24.ps1`
  - **설명**: 메인 점검 및 조치 스크립트입니다. 시스템의 모든 네트워크 어댑터를 확인하여 NetBIOS over TCP/IP가 비활성화되어 있는지 점검합니다. 취약점 발견 시 사용자 동의 하에 자동으로 비활성화 조치를 수행하고, 결과를 `KISA_RESULT/W-24.json` 파일로 저장합니다.
  - **실행 전제 조건**: Windows Server, 관리자 권한

- `set_vulnerabilities.ps1`
  - **설명**: 테스트 목적으로 시스템을 의도적으로 취약한 상태로 만드는 스크립트입니다. 첫 번째 활성 네트워크 어댑터의 NetBIOS 설정을 '사용'으로 변경합니다.
  - **경고**: **테스트 및 시연 목적으로만 사용해야 합니다.** 운영 환경에서는 절대 사용하지 마십시오.

- `W-24.md`
  - **설명**: `W-24.ps1` 스크립트에 대한 상세 설명서입니다. 탐지 및 수정 원리, 시스템 전제조건, 관련 MITRE ATT&CK 기술 매핑 등의 내용을 포함합니다.

- `W-24_Script_Analysis.md`
  - **설명**: 전문가를 위한 스크립트 심층 분석 문서입니다. WMI/CIM 명령어 수준에서 스크립트의 동작 원리를 기술하고, 공격 벡터와 보안 원리를 상세히 설명합니다.

## 3. 사용법

### 3.1. 취약점 점검 및 자동 조치 (기본)

`W-24.ps1` 스크립트는 `-Action` 매개변수를 통해 세 가지 모드로 실행될 수 있습니다: `Detect`, `Remediate`, `Restore`. 기본값은 `Detect`입니다.

1.  PowerShell을 **관리자 권한**으로 실행합니다.
2.  스크립트가 있는 디렉터리로 이동합니다.
    ```powershell
    cd W-24
    ```

3.  **점검 모드 (Detect - 기본값)**
    *   시스템의 NetBIOS over TCP/IP 설정 취약점만을 점검합니다.
    *   조치는 수행하지 않습니다.
    *   실행 명령:
        ```powershell
        .\W-24.ps1 -Action Detect
        # 또는 매개변수 없이 실행 (기본 동작)
        .\W-24.ps1
        ```

4.  **조치 모드 (Remediate)**
    *   취약점을 점검하고, 발견된 취약점에 대해 NetBIOS over TCP/IP를 자동으로 비활성화하는 조치를 수행합니다.
    *   조치 전에 현재 설정을 `W-24.backup.json` 파일로 백업합니다.
    *   실행 명령:
        ```powershell
        .\W-24.ps1 -Action Remediate
        ```

5.  **복원 모드 (Restore)**
    *   이전에 `Remediate` 모드에서 백업된 `W-24.backup.json` 파일을 사용하여 NetBIOS over TCP/IP 설정을 원래 상태로 복원합니다.
    *   백업 파일이 없으면 복원이 불가능합니다.
    *   실행 명령:
        ```powershell
        .\W-24.ps1 -Action Restore
        ```

6.  모든 실행 과정은 `KISA_RESULT/W-24.log`에 기록되며, 최종 결과는 `KISA_RESULT/W-24.json` 파일에 저장됩니다.

### 3.2. 취약점 상태 재현 (테스트용)

1.  PowerShell을 **관리자 권한**으로 실행합니다.
2.  스크립트가 있는 디렉터리로 이동합니다.
    ```powershell
    cd W-24
    ```
3.  취약점 재현 스크립트를 실행합니다.
    ```powershell
    .\set_vulnerabilities.ps1
    ```

---
*이 문서는 제공된 프로젝트 파일들을 기반으로 자동 생성되었습니다.*
